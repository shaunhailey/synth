import React, { Component } from 'react'

export default class Time extends Component {
  constructor(props) {
    super(props)

     function updateTime(){
	   requestAnimationFrame(updateTime)
    	//Tone.now returns the current AudioContext time
	   document.querySelector('span').textContent = Tone.now().toFixed(3)
     }
updateTime()
}

**********

function updateTime(){
	requestAnimationFrame(updateTime)
	//the time elapsed in seconds
	document.querySelector('#seconds').textContent = Tone.Transport.seconds.toFixed(2)
	//the AudioContext time
	document.querySelector('#time').textContent = Tone.now().toFixed(2)
}
updateTime()

//start/stop the transport
document.querySelector('.playToggle').addEventListener('change', function(e){
	if (e.target.checked){
		Tone.Transport.start()
	} else {
		Tone.Transport.stop()
	}
})

*******

function triggerSynth(time){
	//the time is the sample-accurate time of the event
	synth.triggerAttackRelease('C2', '8n', time)
}

//schedule a few notes
Tone.Transport.schedule(triggerSynth, 0)
Tone.Transport.schedule(triggerSynth, '0:2')
Tone.Transport.schedule(triggerSynth, '0:2:2.5')

//set the transport to repeat
Tone.Transport.loopEnd = '1m'
Tone.Transport.loop = true

//start/stop the transport
document.querySelector('.playToggle').addEventListener('change', function(e){
	if (e.target.checked){
		Tone.Transport.start('+0.1')
	} else {
		Tone.Transport.stop()
	}
})

*************

//bpm slider
document.querySelector('#bpm').addEventListener('input', function(e){
	Tone.Transport.bpm.value = parseInt(e.target.value)
})

var synth = new Tone.MetalSynth().toMaster()

function triggerSynth(time){
	synth.triggerAttackRelease('16n', time)
}

Tone.Transport.schedule(triggerSynth, 0)
Tone.Transport.schedule(triggerSynth, '2*8t')
Tone.Transport.schedule(triggerSynth, '4n + 8t')
Tone.Transport.schedule(triggerSynth, '4n + 2*8t')
Tone.Transport.schedule(triggerSynth, '0:2 + 8t')
Tone.Transport.schedule(triggerSynth, '0:3 + 8t')

Tone.Transport.loopEnd = '1m'
Tone.Transport.loop = true

document.querySelector('.playToggle').addEventListener('change', function(e){
	if (e.target.checked){
		Tone.Transport.start('+0.1')
	} else {
		Tone.Transport.stop()
	}
})

***********

//create a loop
var loop = new Tone.Loop(function(time){
	synth.triggerAttackRelease("C1", "8n", time)
}, "4n")

//play the loop between 0-2m on the transport
loop.start(0).stop('2m')

document.querySelector('.playToggle').addEventListener('change', function(e){
	if (e.target.checked){
		Tone.Transport.start('+0.1')
	} else {
		Tone.Transport.stop()
	}
})
